
<!doctype html>
<html>
<head>
<meta charset="UTF-8">
<title></title>
<link rel="stylesheet" href="assets/style.css">
<script type="text/javascript" src="assets/jquery.min.js"></script>

<script type="text/javascript">
	(function (window, document) {
		function randomIntFromInterval(min,max) {
		    return Math.floor(Math.random()*(max-min+1)+min);
		}

		var getIndex = function getIndex(urls) {
			return randomIntFromInterval(0, (urls.length - 1));
		}

		var setupAnimation = function setupAnimation() {
			var iframeContainerID = "#iframeContainer";
			var iframeID = "#animationContainer";
			var isTransitioning = false;
			var fadeOutDuration = 400;
			var fadeInDuration = 400;
			var baseUrl = '/animations';

			var delay = '?time=3000';

			var urls = [
				'/triangulate/',
				'/southwark-triangle/',
				'/voronoi/',
				'/frequency/',
				'/polygon/',
				'/vector/'
			];

			var iframe = document.querySelector('#animationContainer');

			var changeSrc = function changeSrc(src) {

				if(isTransitioning){
					return false;
				}

				isTransitioning = true;
				transitions.show();
				var src = src;

				$(iframeContainerID).fadeTo(fadeOutDuration,0.0,function(){
					$(iframeContainerID).hide();
					$(iframeID).attr("src", baseUrl + src + delay).ready(function(){
						
						$(iframeContainerID).delay(100).fadeTo(fadeInDuration,1.0, function(){
							isTransitioning = false;
							transitions.hide();				
						});
					});
					
				});
				return false;
			}

			var currentSrc = getIndex(urls);
			iframe.src = baseUrl + urls[currentSrc];

			var time = randomIntFromInterval(120000, 180000);
			//var time = 10000;
			
			window.setInterval(function() {
				do {
				    var index = getIndex(urls);
				}
				while (index === currentSrc);
				currentSrc = index;

				time = randomIntFromInterval(120000, 180000);

				var src = urls[index];
				changeSrc(src);

			}, time);
			
		}

		var transitions = {
			src: [ '/particles/', '/transition/'],
			currentSrc: '',
			iframeContainer: '',
			baseUrl: '/transitions',
			init: function(){
				var iframe = document.querySelector('#transitionContainer');
				transitions.iframeContainer = iframe;
			},
			show: function(){
				do {
				    var index = getIndex(transitions.src);
				}
				while (index === transitions.currentSrc);
				transitions.currentSrc = index;

				transitions.iframeContainer.src = transitions.baseUrl + transitions.src[index];
			},

			hide: function(){
				window.setTimeout(function(){
					transitions.iframeContainer.src = '';
				}, 3000);
				
			}
		}

	  window.onload = function() {
		setupAnimation();
		transitions.init();
	  };

	})(window, document);

</script>
</head>
<body>
<div id="iframeContainer">
<iframe id="animationContainer" src="#" scrolling="no" frameborder="0"></iframe>
</div>
<iframe id="transitionContainer" src="#" scrolling="no" frameborder="0"></iframe>
</div>
</body>
</html>
